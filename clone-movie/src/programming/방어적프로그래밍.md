# 방어적 프로그래밍

### 목차

- 방어적 프로그래밍이란?
- 가정 설정문(Assertions)
- 오류의 종류
- 오류를 검사하는 장소
- 방어적 프로그래밍 테크닉

---

### 방어적 프로그래밍?

방어적 프로그래밍(Defensive Programming)은 에상치 못한 입력에도 한 소프트웨어가 계속적 기능 수행을 보장할 수 있도록 고안된 방어적 설계의 한 형태이다. 즉 소프트웨어와 소스코드를 아래의 관점에서
향상시키는 접근법이다.

- 일반적 품질 : 소프트웨어 버그와 문제의 수를 줄인다.
- 소스 코드를 이해하기 쉽게 만든다. : 읽기 쉽고 이해하기 쉬워 코드 리뷰에서 승인된다.
- 소프트웨어가 예상치 못한 입력들이나 사용자의 동작들에도 예상 간으한 방식으로 동작하도록 한다.

---

### 가정 설정문

실수는 일어난다고 가정하고 이에 대비하여 방어적 프로그래밍의 가장 일반적인 방식은 가정 설정문이다. 가정 설정문은 단순하게 프로그램의 특정 지점에서 항상 참이여야 하는 문장이다. 가정 설정문을 만나게 될 때, 가정
설정문의 조건을 확인한다. 참이면 원래 방식대로 동작되며 거짓인 경우 즉시 프로그램을 정지시키고 마련된 오류 메시지를 출력한다.

```java
class Main {
    public static void main(String[] args) {
        double[] numbers = {1.5, -3.2, 4.0, 0.05};
        double total = 0.0;
        for (int i = 0; i < numbers.length; i++) {
            assert n >= 0 + "Data should only contain positive values";
            total += i;
        }
        System.out.println("total : " + total);
    }
}
```

```python
numbers = [1.5, 2.3, 0.7, -0.001, 4.4]
total = 0.0
for n in numbers:
    assert n >= 0.0, 'Data should only contain positive values'
    total += n
print 'total is:', total
```

---

### 오류의 종류

- 입력값이 예상 범위 밖
- 파일이 열리거나 닫혀 있거나, 읽기/쓰기 권한이 정확하지 않은 경우
- 포인터가 null 일 경우
- 최적화된 코드가 원래 코드와 일치하지 않을 경우

---

### 오류를 검사하는 장소

- 외부의 입력값이 들어 올 때
- 매개 변수 값으로 받은 값 검사
- 함수에서 리턴값을 검사

항상 데이터가 온다고 가정을 하고, 코드를 작성하기 보다는 모든 기능이 실패하는 경우가 있기 때문에 혹은 앞으로 어떤 상황이 올 지 모르기 때문에, 데이터들은 무조건 null, undefined, 등 데이터 체크를
하는 습관을 들여야 한다.

---

### 방어적 프로그래밍 테크닉

1. 좋은 코딩 스타일과 건강한 설계를 채용.
2. 코드 작성을 서두르지 마라.
3. 처음부터 끝까지 적절한 곳에서 안전성 체크를 수행하여 취약지점을 살펴보고, 방어적 코드를 가지고 해당 위험을 경계한다.
4. 짧은 코드가 아니라 명료한 코드를 작성한다.
5. 모든 리턴 값을 체크한다.밍
6. 모든 변수는 선언 지점에서 초기화한다.
7. 언어의 표준 설비를 사용한다.
8. 디폴트 동작 제시하기 / 언어의 관용구 따르기 / 수치의 범위 체크하기 / 상수 올바르게 사용하기

---
